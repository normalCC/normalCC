
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1.1', {packages: ['corechart']});
  google.setOnLoadCallback(drawChart);

  function drawChart() {
    // var data = google.visualization.arrayToDataTable(<%= raw @question.graph_data %>); 
    var data = new google.visualization.DataTable();

    data.addColumn('string', "answer_number");
    data.addColumn('number', 'answer_count');
    // data.addColumn({type:'string', role:'annotation'});

    // raw has to be here to allow the quotes
    data.addRows(<%= raw @question.graph_data %>);  

    // var view = new google.visualization.DataView(data);
    // view.setColumns([0, 1, 2, {
    //                         calc: "stringify",
    //                         sourceColumn: 2,
    //                         type: "string",
    //                         role: "annotation"
    //                     }]);

    var options = {
      // annotations: {
      //     alwaysOutside: true,
      //     textStyle: {
      //       fontSize: 16,
      //       color: '#000',
      //       auraColor: 'none'
      //     },
      // },
      chart: {
        title: '<%= @question.title %>',
        subtitle: 'If we want a subtitle it goes here',
      },
      // trendlines: { 1: {} }    // Draw a trendline for data series 0.
      hAxis: {title: '<%= @question.title %>'},
      vAxis: {title: 'weirdness', gridlines: {color: 'transparent'},textPosition: 'none' },
      baselineColor: 'transparent',
      width: 800,
      height: 500, 
      // bar: {groupWidth: "50%"},
      // chartArea: {backgroundColor: "orange"}, 
      // animation: { duration: 1000},  // doesn't seem to do anything exciting...
      legend: { position: 'none' }
    };

    // var chart = new google.charts.Bar(document.getElementById('columnchart'));
    // chart.draw(data, google.charts.Bar.convertOptions(options));
    var chart = new google.visualization.ColumnChart(document.getElementById("columnchart"));
    chart.draw(data, options);

  }
</script>

<div id="columnchart"></div>
<%= raw @question.graph_data %>
